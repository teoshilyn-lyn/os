/*Кузнецова А.А.
БСБО-05-19
1-3 задания сдала на паре, это 4 и 5, реализованные через методы*/

using System;
using System.IO;
using System.IO.Compression;
using System.Xml;

namespace labs
{
    class Program
    {

        static void t4()
        {
            var xml = new XmlDocument();
            xml.LoadXml("<item><text>lab4</text></item>");
            XmlElement xmlel = xml.CreateElement("test1");
            XmlWriter writer = XmlWriter.Create(@"D:\Documents\test.xml");
            xml.Save(writer);
            Console.WriteLine(xml.InnerXml);
            Console.ReadKey();
            writer.Close();
            File.Delete(@"D:\Documents\test.xml");
        }
        static void t5()
        {
            string startpath = @"D:\Documents\forzip";
            string zippath = @"D:\Documents\qwe.zip";
            string extractpath = @"D:\Documents\extract";
            ZipFile.CreateFromDirectory(startpath, zippath);
            ZipFile.ExtractToDirectory(zippath, extractpath);
            using (FileStream zipToOpen = new FileStream(@"D:\Documents\qwe.zip", FileMode.Open))
            {
                using (ZipArchive archive = new ZipArchive(zipToOpen, ZipArchiveMode.Update))
                {
                    ZipArchiveEntry readmeEntry = archive.GetEntry("forzip.txt");

                    Console.WriteLine("Объём " + readmeEntry.CompressedLength);
                    Console.WriteLine("Объём 1" + readmeEntry.Length);
                }
            }
            Console.ReadKey();
            File.Delete(@"D:\Documents\qwe.zip");
        }
    }
    public class test
    {
        public String answ { get; set; }
    }
    
     static void Main(string[] args)
        {
            int i = int.Parse(Console.ReadLine());
            switch (i)
            {
                case 4:
                    t4();
                    break;
                case 5:
                    t5();
                    break;
            }
        }
}
